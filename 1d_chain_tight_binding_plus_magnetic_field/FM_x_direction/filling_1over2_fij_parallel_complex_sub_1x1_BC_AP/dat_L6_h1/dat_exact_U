list_kx [-2.61799388 -1.57079633 -0.52359878  0.52359878  1.57079633  2.61799388]
list_ikx [0 1 2 3 4 5]
list_mikx [5 4 3 2 1 0]
list_enekx [ 1.23205081  2.23205081 -0.5         0.5        -2.23205081 -1.23205081
 -2.23205081 -1.23205081 -0.5         0.5         1.23205081  2.23205081]
list_veckx [[-0.70710678 -0.70710678]
 [-0.70710678  0.70710678]
 [ 0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [ 0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [ 0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [ 0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678 -0.70710678]
 [-0.70710678  0.70710678]]
list_intkx [ 0  1  2  3  4  5  6  7  8  9 10 11]
list_sorted_enekx [-2.23205081 -2.23205081 -1.23205081 -1.23205081 -0.5        -0.5
  0.5         0.5         1.23205081  1.23205081  2.23205081  2.23205081]
list_sorted_veckx [[ 0.70710678  0.70710678]
 [ 0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [ 0.70710678  0.70710678]
 [ 0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678 -0.70710678]
 [-0.70710678 -0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678  0.70710678]]
list_sorted_intkx [ 4  6  5  7  2  8  3  9 10  0 11  1]

list_enekx [-2.23205081 -2.23205081 -1.23205081 -1.23205081 -0.5        -0.5
  0.5         0.5         1.23205081  1.23205081  2.23205081  2.23205081]
 (numel) 6
 <= numel-1 [-2.23205081 -2.23205081 -1.23205081 -1.23205081 -0.5        -0.5       ]
 >= numel [0.5        0.5        1.23205081 1.23205081 2.23205081 2.23205081]
numel 6
intkx [ 4  6  5  7  2  8  3  9 10  0 11  1]
veckx [[ 0.70710678  0.70710678]
 [ 0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [ 0.70710678  0.70710678]
 [ 0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678 -0.70710678]
 [-0.70710678 -0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678  0.70710678]]

x [2 3 2 3 1 4 1 4 5 0 5 0]
intkx [ 4  6  5  7  2  8  3  9 10  0 11  1]
px [2 3 2 3 1 4 1 4 5 0 5 0]
mx [3 2 3 2 4 1 4 1 0 5 0 5]
pkx [-0.52359878  0.52359878 -0.52359878  0.52359878 -1.57079633  1.57079633
 -1.57079633  1.57079633  2.61799388 -2.61799388  2.61799388 -2.61799388]
mkx [ 0.52359878 -0.52359878  0.52359878 -0.52359878  1.57079633 -1.57079633
  1.57079633 -1.57079633 -2.61799388  2.61799388 -2.61799388  2.61799388]
spin [0 0 1 1 0 0 1 1 0 0 1 1]
sub [0 0 0 0 0 0 0 0 0 0 0 0]
ss [0 0 1 1 0 0 1 1 0 0 1 1]
Nspin 2
Nsub 0

chosen index 6
c_left^dagger  0 3 6 [1] [6]
c_right^dagger 0 2 4 [0] [4]
coeff_left  [[0.70710678 0.70710678]]
coeff_right [[0.70710678 0.70710678]]
ikx 3
kx 0.523598775598299
fk [[0.5 0.5]
 [0.5 0.5]]
sum_k fk [[0.5+0.j 0.5+0.j]
 [0.5+0.j 0.5+0.j]]
----
chosen index 7
c_left^dagger  1 3 7 [3] [7]
c_right^dagger 1 2 5 [2] [5]
coeff_left  [[-0.70710678  0.70710678]]
coeff_right [[-0.70710678  0.70710678]]
ikx 3
kx 0.523598775598299
fk [[ 0.5 -0.5]
 [-0.5  0.5]]
sum_k fk [[1.+0.j 0.+0.j]
 [0.+0.j 1.+0.j]]
----
chosen index 8
c_left^dagger  0 4 8 [5] [8]
c_right^dagger 0 1 2 [4] [2]
coeff_left  [[0.70710678 0.70710678]]
coeff_right [[0.70710678 0.70710678]]
ikx 4
kx 1.5707963267948966
fk [[0.5 0.5]
 [0.5 0.5]]
sum_k fk [[0.5+0.j 0.5+0.j]
 [0.5+0.j 0.5+0.j]]
----

all nonzero fk (fk=0 for -pi<k<0)
# list_ikx [0 1 2 3 4 5]
# list_kx [-2.61799388 -1.57079633 -0.52359878  0.52359878  1.57079633  2.61799388]
0 0 [0. +0.j 0. +0.j 0. +0.j 1. +0.j 0.5+0.j 0. +0.j]
0 1 [0. +0.j 0. +0.j 0. +0.j 0. +0.j 0.5+0.j 0. +0.j]
1 0 [0. +0.j 0. +0.j 0. +0.j 0. +0.j 0.5+0.j 0. +0.j]
1 1 [0. +0.j 0. +0.j 0. +0.j 1. +0.j 0.5+0.j 0. +0.j]

all nonzero fij
0 0 [0.+0.j         0.-1.33333333j 0.-1.15470054j 0.-0.66666667j
 0.-1.15470054j 0.-1.33333333j]
0 1 [0.+0.00000000e+00j 0.+6.66666667e-01j 0.+8.16404236e-17j
 0.-6.66666667e-01j 0.-1.63280847e-16j 0.+6.66666667e-01j]
1 0 [0.+0.00000000e+00j 0.+6.66666667e-01j 0.+8.16404236e-17j
 0.-6.66666667e-01j 0.-1.63280847e-16j 0.+6.66666667e-01j]
1 1 [0.+0.j         0.-1.33333333j 0.-1.15470054j 0.-0.66666667j
 0.-1.15470054j 0.-1.33333333j]

vmcfijud [[0.+0.00000000e+00j 0.+6.66666667e-01j 0.+8.16404236e-17j
  0.-6.66666667e-01j 0.-1.63280847e-16j 0.+6.66666667e-01j]]
vmcfijdu [[0.+0.00000000e+00j 0.+6.66666667e-01j 0.+8.16404236e-17j
  0.-6.66666667e-01j 0.-1.63280847e-16j 0.+6.66666667e-01j]]
vmcfijuu [[0.+0.j         0.-1.33333333j 0.-1.15470054j 0.-0.66666667j
  0.-1.15470054j 0.-1.33333333j]]
vmcfijdd [[0.+0.j         0.-1.33333333j 0.-1.15470054j 0.-0.66666667j
  0.-1.15470054j 0.-1.33333333j]]

all vmcfij
  0 0 0j
  0 1 0.6666666666666665j
  0 2 8.164042358815846e-17j
  0 3 -0.6666666666666665j
  0 4 -1.6328084717631692e-16j
  0 5 0.6666666666666665j
# 0 0 0j
# 0 1 0.6666666666666665j
# 0 2 8.164042358815846e-17j
# 0 3 -0.6666666666666665j
# 0 4 -1.6328084717631692e-16j
# 0 5 0.6666666666666665j
# 0 0 0j
  0 1 -1.333333333333333j
  0 2 -1.1547005383792515j
  0 3 -0.6666666666666665j
# 0 4 -1.1547005383792506j
# 0 5 -1.3333333333333317j
# 0 0 0j
  0 1 -1.333333333333333j
  0 2 -1.1547005383792515j
  0 3 -0.6666666666666665j
# 0 4 -1.1547005383792506j
# 0 5 -1.3333333333333317j
