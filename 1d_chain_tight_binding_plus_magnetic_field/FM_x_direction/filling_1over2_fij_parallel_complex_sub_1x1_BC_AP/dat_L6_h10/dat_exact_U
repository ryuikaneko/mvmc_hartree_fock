list_kx [-2.61799388 -1.57079633 -0.52359878  0.52359878  1.57079633  2.61799388]
list_ikx [0 1 2 3 4 5]
list_mikx [5 4 3 2 1 0]
list_enekx [-3.26794919  6.73205081 -5.          5.         -6.73205081  3.26794919
 -6.73205081  3.26794919 -5.          5.         -3.26794919  6.73205081]
list_veckx [[-0.70710678 -0.70710678]
 [-0.70710678  0.70710678]
 [ 0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [ 0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [ 0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [ 0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678 -0.70710678]
 [-0.70710678  0.70710678]]
list_intkx [ 0  1  2  3  4  5  6  7  8  9 10 11]
list_sorted_enekx [-6.73205081 -6.73205081 -5.         -5.         -3.26794919 -3.26794919
  3.26794919  3.26794919  5.          5.          6.73205081  6.73205081]
list_sorted_veckx [[ 0.70710678  0.70710678]
 [ 0.70710678  0.70710678]
 [ 0.70710678  0.70710678]
 [ 0.70710678  0.70710678]
 [-0.70710678 -0.70710678]
 [-0.70710678 -0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678  0.70710678]]
list_sorted_intkx [ 4  6  2  8 10  0  5  7  3  9 11  1]

list_enekx [-6.73205081 -6.73205081 -5.         -5.         -3.26794919 -3.26794919
  3.26794919  3.26794919  5.          5.          6.73205081  6.73205081]
 (numel) 6
 <= numel-1 [-6.73205081 -6.73205081 -5.         -5.         -3.26794919 -3.26794919]
 >= numel [3.26794919 3.26794919 5.         5.         6.73205081 6.73205081]
numel 6
intkx [ 4  6  2  8 10  0  5  7  3  9 11  1]
veckx [[ 0.70710678  0.70710678]
 [ 0.70710678  0.70710678]
 [ 0.70710678  0.70710678]
 [ 0.70710678  0.70710678]
 [-0.70710678 -0.70710678]
 [-0.70710678 -0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678  0.70710678]]

x [2 3 1 4 5 0 2 3 1 4 5 0]
intkx [ 4  6  2  8 10  0  5  7  3  9 11  1]
px [2 3 1 4 5 0 2 3 1 4 5 0]
mx [3 2 4 1 0 5 3 2 4 1 0 5]
pkx [-0.52359878  0.52359878 -1.57079633  1.57079633  2.61799388 -2.61799388
 -0.52359878  0.52359878 -1.57079633  1.57079633  2.61799388 -2.61799388]
mkx [ 0.52359878 -0.52359878  1.57079633 -1.57079633 -2.61799388  2.61799388
  0.52359878 -0.52359878  1.57079633 -1.57079633 -2.61799388  2.61799388]
spin [0 0 0 0 0 0 1 1 1 1 1 1]
sub [0 0 0 0 0 0 0 0 0 0 0 0]
ss [0 0 0 0 0 0 1 1 1 1 1 1]
Nspin 0
Nsub 0

chosen index 6
c_left^dagger  0 3 6 [1] [6]
c_right^dagger 0 2 4 [0] [4]
coeff_left  [[0.70710678 0.70710678]]
coeff_right [[0.70710678 0.70710678]]
ikx 3
kx 0.523598775598299
fk [[0.5 0.5]
 [0.5 0.5]]
sum_k fk [[0.5+0.j 0.5+0.j]
 [0.5+0.j 0.5+0.j]]
----
chosen index 8
c_left^dagger  0 4 8 [3] [8]
c_right^dagger 0 1 2 [2] [2]
coeff_left  [[0.70710678 0.70710678]]
coeff_right [[0.70710678 0.70710678]]
ikx 4
kx 1.5707963267948966
fk [[0.5 0.5]
 [0.5 0.5]]
sum_k fk [[0.5+0.j 0.5+0.j]
 [0.5+0.j 0.5+0.j]]
----
chosen index 10
c_left^dagger  0 5 10 [4] [10]
c_right^dagger 0 0 0 [5] [0]
coeff_left  [[-0.70710678 -0.70710678]]
coeff_right [[-0.70710678 -0.70710678]]
ikx 5
kx 2.617993877991494
fk [[0.5 0.5]
 [0.5 0.5]]
sum_k fk [[0.5+0.j 0.5+0.j]
 [0.5+0.j 0.5+0.j]]
----

all nonzero fk (fk=0 for -pi<k<0)
# list_ikx [0 1 2 3 4 5]
# list_kx [-2.61799388 -1.57079633 -0.52359878  0.52359878  1.57079633  2.61799388]
0 0 [0. +0.j 0. +0.j 0. +0.j 0.5+0.j 0.5+0.j 0.5+0.j]
0 1 [0. +0.j 0. +0.j 0. +0.j 0.5+0.j 0.5+0.j 0.5+0.j]
1 0 [0. +0.j 0. +0.j 0. +0.j 0.5+0.j 0.5+0.j 0.5+0.j]
1 1 [0. +0.j 0. +0.j 0. +0.j 0.5+0.j 0.5+0.j 0.5+0.j]

all nonzero fij
0 0 [0.+0.00000000e+00j 0.-1.33333333e+00j 0.+7.40148683e-17j
 0.-6.66666667e-01j 0.-1.48029737e-16j 0.-1.33333333e+00j]
0 1 [0.+0.00000000e+00j 0.+1.33333333e+00j 0.-7.40148683e-17j
 0.+6.66666667e-01j 0.+1.48029737e-16j 0.+1.33333333e+00j]
1 0 [0.+0.00000000e+00j 0.+1.33333333e+00j 0.-7.40148683e-17j
 0.+6.66666667e-01j 0.+1.48029737e-16j 0.+1.33333333e+00j]
1 1 [0.+0.00000000e+00j 0.-1.33333333e+00j 0.+7.40148683e-17j
 0.-6.66666667e-01j 0.-1.48029737e-16j 0.-1.33333333e+00j]

vmcfijud [[0.+0.00000000e+00j 0.+1.33333333e+00j 0.-7.40148683e-17j
  0.+6.66666667e-01j 0.+1.48029737e-16j 0.+1.33333333e+00j]]
vmcfijdu [[0.+0.00000000e+00j 0.+1.33333333e+00j 0.-7.40148683e-17j
  0.+6.66666667e-01j 0.+1.48029737e-16j 0.+1.33333333e+00j]]
vmcfijuu [[0.+0.00000000e+00j 0.-1.33333333e+00j 0.+7.40148683e-17j
  0.-6.66666667e-01j 0.-1.48029737e-16j 0.-1.33333333e+00j]]
vmcfijdd [[0.+0.00000000e+00j 0.-1.33333333e+00j 0.+7.40148683e-17j
  0.-6.66666667e-01j 0.-1.48029737e-16j 0.-1.33333333e+00j]]

all vmcfij
  0 0 0j
  0 1 1.3333333333333333j
  0 2 -7.401486830834377e-17j
  0 3 0.6666666666666665j
  0 4 1.4802973661668753e-16j
  0 5 1.3333333333333317j
# 0 0 0j
# 0 1 1.3333333333333333j
# 0 2 -7.401486830834377e-17j
# 0 3 0.6666666666666665j
# 0 4 1.4802973661668753e-16j
# 0 5 1.3333333333333317j
# 0 0 0j
  0 1 -1.3333333333333333j
  0 2 7.401486830834377e-17j
  0 3 -0.6666666666666665j
# 0 4 -1.4802973661668753e-16j
# 0 5 -1.3333333333333317j
# 0 0 0j
  0 1 -1.3333333333333333j
  0 2 7.401486830834377e-17j
  0 3 -0.6666666666666665j
# 0 4 -1.4802973661668753e-16j
# 0 5 -1.3333333333333317j
