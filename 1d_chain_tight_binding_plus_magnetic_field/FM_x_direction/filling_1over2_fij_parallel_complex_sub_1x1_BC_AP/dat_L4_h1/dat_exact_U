list_kx [-2.35619449 -0.78539816  0.78539816  2.35619449]
list_ikx [0 1 2 3]
list_mikx [3 2 1 0]
list_enekx [ 0.91421356  1.91421356 -1.91421356 -0.91421356 -1.91421356 -0.91421356
  0.91421356  1.91421356]
list_veckx [[-0.70710678 -0.70710678]
 [-0.70710678  0.70710678]
 [ 0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [ 0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678 -0.70710678]
 [-0.70710678  0.70710678]]
list_intkx [0 1 2 3 4 5 6 7]
list_sorted_enekx [-1.91421356 -1.91421356 -0.91421356 -0.91421356  0.91421356  0.91421356
  1.91421356  1.91421356]
list_sorted_veckx [[ 0.70710678  0.70710678]
 [ 0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678 -0.70710678]
 [-0.70710678 -0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678  0.70710678]]
list_sorted_intkx [2 4 3 5 0 6 1 7]

list_enekx [-1.91421356 -1.91421356 -0.91421356 -0.91421356  0.91421356  0.91421356
  1.91421356  1.91421356]
 (numel) 4
 <= numel-1 [-1.91421356 -1.91421356 -0.91421356 -0.91421356]
 >= numel [0.91421356 0.91421356 1.91421356 1.91421356]
numel 4
intkx [2 4 3 5 0 6 1 7]
veckx [[ 0.70710678  0.70710678]
 [ 0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678 -0.70710678]
 [-0.70710678 -0.70710678]
 [-0.70710678  0.70710678]
 [-0.70710678  0.70710678]]

x [1 2 1 2 0 3 0 3]
intkx [2 4 3 5 0 6 1 7]
px [1 2 1 2 0 3 0 3]
mx [2 1 2 1 3 0 3 0]
pkx [-0.78539816  0.78539816 -0.78539816  0.78539816 -2.35619449  2.35619449
 -2.35619449  2.35619449]
mkx [ 0.78539816 -0.78539816  0.78539816 -0.78539816  2.35619449 -2.35619449
  2.35619449 -2.35619449]
spin [0 0 1 1 0 0 1 1]
sub [0 0 0 0 0 0 0 0]
ss [0 0 1 1 0 0 1 1]
Nspin 2
Nsub 0

chosen index 4
c_left^dagger  0 2 4 [1] [4]
c_right^dagger 0 1 2 [0] [2]
coeff_left  [[0.70710678 0.70710678]]
coeff_right [[0.70710678 0.70710678]]
ikx 2
kx 0.7853981633974483
fk [[0.5 0.5]
 [0.5 0.5]]
sum_k fk [[0.5+0.j 0.5+0.j]
 [0.5+0.j 0.5+0.j]]
----
chosen index 5
c_left^dagger  1 2 5 [3] [5]
c_right^dagger 1 1 3 [2] [3]
coeff_left  [[-0.70710678  0.70710678]]
coeff_right [[-0.70710678  0.70710678]]
ikx 2
kx 0.7853981633974483
fk [[ 0.5 -0.5]
 [-0.5  0.5]]
sum_k fk [[1.+0.j 0.+0.j]
 [0.+0.j 1.+0.j]]
----

all nonzero fk (fk=0 for -pi<k<0)
# list_ikx [0 1 2 3]
# list_kx [-2.35619449 -0.78539816  0.78539816  2.35619449]
0 0 [0.+0.j 0.+0.j 1.+0.j 0.+0.j]
1 1 [0.+0.j 0.+0.j 1.+0.j 0.+0.j]

all nonzero fij
0 0 [0.+0.j         0.-1.41421356j 0.-2.j         0.-1.41421356j]
1 1 [0.+0.j         0.-1.41421356j 0.-2.j         0.-1.41421356j]

vmcfijud [[0.+0.j 0.+0.j 0.+0.j 0.+0.j]]
vmcfijdu [[0.+0.j 0.+0.j 0.+0.j 0.+0.j]]
vmcfijuu [[0.+0.j         0.-1.41421356j 0.-2.j         0.-1.41421356j]]
vmcfijdd [[0.+0.j         0.-1.41421356j 0.-2.j         0.-1.41421356j]]

all vmcfij
  0 0 0j
  0 1 0j
  0 2 0j
  0 3 0j
# 0 0 0j
# 0 1 0j
# 0 2 0j
# 0 3 0j
# 0 0 0j
  0 1 -1.4142135623730947j
  0 2 -1.9999999999999996j
# 0 3 -1.414213562373095j
# 0 0 0j
  0 1 -1.4142135623730947j
  0 2 -1.9999999999999996j
# 0 3 -1.414213562373095j
